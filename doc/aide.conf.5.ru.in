.TH "aide.conf" "5"
.SH "НАЗВАНИЕ"
aide.conf - Конфигурационный файл для Advanced Intrusion Detection
Environment 
.PP
.SH "СИНТАКСИС"
\fBaide.conf\fP это конфигурационный файл для Advanced Intrusion
Detection Environment. \fBaide.conf\fP содержит данные кофигурации
используемые для создания или проверки базы данных aide.
.PP
.SH "ФОРМАТ ФАЙЛА"
\fBaide.conf\fP подобен  конфигурационному файлу программы Tripwire (tm).
C небольшими усилиями можно перевести tw.conf в aide.conf.
.PP
Записи в Aide.conf чувствительны к регистру. Первые и  последние пробелы 
в строке игнорируются.
.PP
Существует три типа строк в \fBaide.conf\fP. Во-первых, это строки конфигурации
которые используются для установки параметров и назначения/отмены переменных.
Второй тип строк используется для выбора файлов добавляемых в базу. Третий-
это макросы. Только второй тип строк необходим для работоспособности aide.
Строки начинающиеся со знака # игнорируются как коментарии.
.PP
.SH "СТРОКИ КОНФИГУРАЦИИ"
.PP
Эти строки имеют формат "параметр=значение". Смотрите  URLS для ознакомления со
списком возможных.
.PP
.IP database
Это URL указывающий на метоположение базы для чтения. Может присутствовать только
одна строка этого типа. Если указано несколько, то будет использоваться только первая.
Значение по умолчанию "@prefix@/etc/aide.db".
.IP database_out
URL указывает местоположение для записи новой, только что созданной базы.
Может присутствовать только
одна строка этого типа. Если указано несколько, то будет использоваться только первая.
Значение по умолчанию"@prefix@/etc/aide.db.new".
.IP verbose
Уровень подробности сообщений на выводе. Это значение может быть между 0 и 255
включительно. Этот параметр задается только один раз. Используется значение указанное
первый раз. Если используется --verbose или -V то значение переписывается новым,
там указанным. Значение по умолчанию 5. Если подробность установлена в 20 то
появляются дополнительные сообщения во время выполнения --check или --update.
.IP report_url
местоположение куда будет направлен вывод. Может присутствовать несколько строк
данного типа. Вывод будет осуществляться во все указанные. По умолчанию это стандартный вывод.
.IP gzip_dbout
Осуществлять вывод в базу используя сжатие gzip или нет. Допустимые
значения yes, true, no и false. По умолчанию сжатие не осуществляется.
Этот параметр доступен только если программа собрана с поддержкой zlib.
.IP "Определения групп"
Если параметр не один из выше перечисленных, то он трактуется как определение групп.
Значение представлено выражением. Выражение имеет следующий вид.
.LP 
<предопределенная группа>| <выражение> + <предопределенная группа>
		  | <выражение> - <предопределенная группа>
.IP
Смотрите СТАНДАРТНЫЕ ГРУППЫ на предмет предопределенных групп.
Этметим, что это несколько отлично от того как делается в Tripwire(tm)
.IP
Существует также специальная группа именуемая "ignore_list". Предопределенные 
группы включенные в нее НЕ будут отражены в окончательном отчете.
.PP
.SH "СТРОКИ ВЫБОРА"
.PP
Существуют три типа строк выбора (обычные, отрицательные, равенства)
Строки начинающиеся с "/" обычные строки выбора (/home/*). Строки
начинающиеся с "!" это отрицательные строки. А строки начинающиеся со знака "="
это строки-равенства. Строка следующая за первым символом трактуется как
регулярное выражение соотвествующее полному имени файлы (с указанием полного пути)
При обычном правиле выбора "/" включается в регулярное выражение.Возможны регулярные выражения в выражениях.
Смотрите СТРОКИ КОНФИГУРАЦИИ на предмет возможных выражений. Смотрите ПРИМЕРЫ и 
doc/aide.conf на предмет примеров.
.PP
.SH "СТРОКИ МАКРОСЫ"
.PP
.IP "@@define \fBVAR\fR \fBval\fR"
Назначить переменной \fBVAR\fR значение \fBval\fR.
.IP "@@undef \fBVAR\fR"
Отменить значение переменной \fBVAR\fR.
.IP "@@ifdef \fBVAR\fR, @@ifndef \fBVAR\fR"
@@ifdef начало условного выражения if . Оно должно заверщиться с @@endif.
Строки между @@ifdef и @@endif используются если переменная
\fBVAR\fR определена. Если есть условие @@else то часть между
@@ifdef и @@else используется если \fBVAR\fR определена, в противном случае
используется часть между @@else и @@endif .Выражение @@ifndef имеет
логику обратную к @@ifdef но в остальном работает также.
.IP "@@ifhost \fBhostname\fR, @@ifnhost \fBhostname\fR"
@@ifhost работает как @@ifdef только в отличие от него проверяет 
равно ли \fBhostname\fR имени машины на которой запущен aide.
\fBhostname\fR это имя машины без имени домена
(hostname, но не hostname.aide.org).
.IP "@{\fBVAR\fR}"
Выражение @@{\fBVAR\fR} заменяется значением переменной \fBVAR\fR.
Если переменная \fBVAR\fR не определена,то используется пустая строка. В
Tripwire(tm) @@VAR НЕ поддерживаются.
.IP "@@else"
Начало альтернативной части выражения.
.IP "@@endif"
Окончание условного выражения if.
.IP "@@include \fBVAR\fR"
Включает файл \fBVAR\fR. Содержимое файла используется как если бы он был
частью конфигурационного файла.
.PP
.SH URLS
Местоположение может быть одним из следующий. Входящие URL не могут быть
использованы как выходные и наоборот
.IP stdout
.IP stderr
Выходные данные направытся в stdout и stderr соответственно.
.IP stdin
Входные данные берутся с stdin.
.IP file://\fBfilename\fR
Входные данные берутся из файла с именем \fBfilename\fR или туда записываются выходные.
.IP fd:\fBnumber\fR
Входные данные берутся из дескриптора с номером \fBnumber\fR или туда записываются выходные.
.PP
.SH "СТАНДАРТНЫЕ ГРУППЫ"
.PP
.IP "p:	права"
.IP "i:	inode"
.IP "n:	количество ссылок"
.IP "u:	пользователь"
.IP "g:	группа"
.IP "s:	размер"
.IP "m:	время модификации"
.IP "a:	время доступа"
.IP "c:	время создания"
.IP "S:	проверка на увеличение/изменение размера"
.IP "md5:	md5 checksum"
.IP "sha1:	sha1 checksum"
.IP "rmd160:     rmd160 checksum"
.IP "tiger:     tiger checksum"
.IP "R:	p+i+n+u+g+s+m+c+md5"
.IP "L:	p+i+n+u+g"
.IP "E:	Пустая группа"
.IP ">:	Постоянно увеличивающийся лог-файл p+u+g+i+n+S"
.IP "Возможны также, если при сборке выбранна поддержка mhash"
.IP "crc32:	crc32 checksum"
.IP "haval:	haval checksum"
.IP "gost:	gost checksum"


.PP
.SH ПРИМЕРЫ
.IP
.B "/	R"
.LP
Это добавляет все файлы вашей машины. Эта одна строка вполне достаточна для конфигурационного файла.
.IP
.B "!/dev"
.LP
Игнорировать структуру каталога /dev.
.IP
.B "=/tmp"
.LP
Добавить только /tmp в базу, но не добавлять его подкаталоги.
.IP 
.B "\fBAll\fR=p+i+n+u+g+s+m+c+a+md5+sha1+tiger+rmd160"
.LP 
Эта строка назначает группу \fBAll\fR. Она включает в себя все аттрибуты и все
возможные контрольные суммы. Если вы действительно желаете использовать все
доступные контрольные суммы, то следует включить поддержку mhash при сборке и
добавить +crc32+haval+gost в конец определения группы \fBAll\fR.Обращаем внимание,
что поддержка Mhash может быть включена только во время сборки.
.PP
.SH СОВЕТЫ
.IP
.B "=/foo R"
.IP
.B "/foo/bar R"
.LP
Этот параметр добавит все файлы в /foo поскольку они соответствуют /foo,
что эквивалентно /foo.* (напомним, что в строках выбора используются регулярные выражения). Возможно вы в действительности жалали написать следующее:

.IP 
.B "=/foo$ R"
.IP
.B "/foo/bar R"
.LP 
Отметим, что следующее выражение работает, поскольку /foo добавляется не
рекурсивно.
.IP
.B "=/foo R"
 А вот первое выражение не разрешено в AIDE. Вместо этого используйте
.IP
.B "/foo epug"
.IP 
.B "/foo e+p+u+g"
.PP
.SH "СМ. ТАКЖЕ"
.BR aide (1)
.BR http://www.cs.tut.fi/~rammer/aide/manual.html
.SH DISCLAIMER
All trademarks are the property of their respective owners.
No animals were harmed while making this webpage or this piece of
software.
.SH "ПЕРЕВОД"
Translation by Stanislav I. Ievlev <inger@linux.ru.net>

